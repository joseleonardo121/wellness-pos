<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>{% block title %}Wellness{% endblock %}</title>

  <!-- Bootstrap & FontAwesome -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

  <!-- SweetAlert -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    /* ====== General ====== */
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: row;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f8fafc;
      overflow-x: hidden;
    }

    /* ====== Loader ====== */
    #loader {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background-color: #0d6efd;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 9999;
      transition: opacity 0.6s ease, visibility 0.6s ease;
    }

    #loader h1 {
      font-size: 2rem;
      letter-spacing: 2px;
      animation: pulse 1.5s infinite;
    }

    @keyframes pulse {
      0% { opacity: 0.6; transform: scale(0.98); }
      50% { opacity: 1; transform: scale(1.02); }
      100% { opacity: 0.6; transform: scale(0.98); }
    }

    #loader.fade-out {
      opacity: 0;
      visibility: hidden;
    }

    /* ====== Sidebar ====== */
    .sidebar {
      min-width: 240px;
      max-width: 240px;
      background: linear-gradient(180deg, #2c3038 0%, #1e2127 100%);
      color: #fff;
      display: flex;
      flex-direction: column;
      padding: 1rem 0.5rem;
      box-shadow: 4px 0 10px rgba(0, 0, 0, 0.2);
    }

    .sidebar h4 {
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 1rem;
      padding-left: 1rem;
      color: #0d6efd;
    }

    .user-info {
      font-size: 0.9rem;
      color: #adb5bd;
      padding-left: 1rem;
      margin-bottom: 1rem;
    }

    .sidebar a {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 15px;
      margin: 4px 8px;
      color: #ced4da;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.25s ease;
      font-weight: 500;
    }

    .sidebar a:hover {
      background-color: rgba(13,110,253,0.15);
      color: #fff;
      transform: translateX(4px);
    }

    .sidebar .active {
      background-color: #0d6efd;
      color: #fff !important;
      box-shadow: 0 0 10px rgba(13,110,253,0.5);
    }

    .sidebar hr {
      border-top: 1px solid #495057;
      margin: 12px 0;
    }

    /* ====== Topbar ====== */
    .topbar {
      width: 100%;
      background-color: #fff;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
      position: sticky;
      top: 0;
      z-index: 10;
      border-bottom: 1px solid #e5e7eb;
    }

    .topbar h2 {
      font-weight: 700;
      color: #343a40;
      margin: 0;
    }

    .topbar .user {
      font-weight: 500;
      color: #555;
    }

    /* ====== Content ====== */
    .content {
      flex-grow: 1;
      padding: 2rem 2.5rem;
      animation: fadeIn 0.4s ease-in-out;
      width: 100%;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* ====== Responsive ====== */
    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        min-width: 100%;
        max-width: 100%;
        flex-direction: row;
        overflow-x: auto;
      }
      .sidebar a {
        flex: 1 0 auto;
        justify-content: center;
        padding: 10px 5px;
      }
    }
  </style>
</head>
<body>
  <!-- Loader -->
  <div id="loader">
    <h1>üèãÔ∏è‚Äç‚ôÄÔ∏è WELLNESS</h1>
    <div class="spinner-border text-light mt-3" role="status"></div>
  </div>

  <!-- Sidebar -->
  <div class="sidebar">
    <h4>üè¨ WELLNESS</h4>

    <div class="user-info">
      {% if request.user.is_authenticated %}
        üë§ {{ request.user.get_full_name|default:request.user.username }}
      {% else %}
        üë§ Invitado
      {% endif %}
    </div>

    <hr>

    <!-- Productos -->
    <a href="{% url 'lista_productos' %}" class="{% if request.resolver_match.url_name == 'lista_productos' %}active{% endif %}">
      <i class="fa-solid fa-box"></i> Productos
    </a>

    <hr>

    <!-- Ventas -->
    {% if request.user.is_authenticated %}
    <a class="d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#ventasSubmenu" role="button" aria-expanded="false" aria-controls="ventasSubmenu">
      <span><i class="fa-solid fa-cart-shopping"></i> Ventas</span>
      <i class="fa-solid fa-chevron-down"></i>
    </a>
    <div class="collapse" id="ventasSubmenu">
      <a href="{% url 'crear_venta' %}" class="{% if request.resolver_match.url_name == 'crear_venta' %}active{% endif %}">Nueva Venta</a>
      <a href="{% url 'historial_ventas' %}" class="{% if request.resolver_match.url_name == 'historial_ventas' %}active{% endif %}">Historial Ventas</a>
    </div>
    <hr>

    <!-- Traspasos -->
    <a class="d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#traspasosSubmenu" role="button" aria-expanded="false" aria-controls="traspasosSubmenu">
      <span><i class="fa-solid fa-arrows-repeat"></i> Traspasos</span>
      <i class="fa-solid fa-chevron-down"></i>
    </a>
    <div class="collapse" id="traspasosSubmenu">
      <a href="{% url 'lista_traspasos' %}" class="{% if request.resolver_match.url_name == 'lista_traspasos' %}active{% endif %}">Lista de Traspasos</a>
      <a href="{% url 'crear_traspaso' %}" class="{% if request.resolver_match.url_name == 'crear_traspaso' %}active{% endif %}">Nuevo Traspaso</a>
    </div>
    <hr>

    <!-- Clientes -->
    <a href="{% url 'listar_clientes' %}" class="{% if request.resolver_match.url_name == 'listar_clientes' %}active{% endif %}">
      <i class="fa-solid fa-users"></i> Clientes
    </a>
    {% endif %}

    {% if request.user.is_staff or request.user.is_superuser %}
      <hr>

      <a href="{% url 'lista_notas_cambio' %}" class="{% if request.resolver_match.url_name == 'lista_notas_cambio' %}active{% endif %}">
        <i class="fa-solid fa-arrow-right-arrow-left"></i> Notas de Cambio
      </a>

      <a class="d-flex justify-content-between align-items-center" data-bs-toggle="collapse" href="#reportesSubmenu" role="button" aria-expanded="false" aria-controls="reportesSubmenu">
        <span><i class="fa-solid fa-chart-line"></i> Reportes</span>
        <i class="fa-solid fa-chevron-down"></i>
      </a>
      <div class="collapse" id="reportesSubmenu">
        <a href="{% url 'reportes' %}" class="{% if request.resolver_match.url_name == 'reportes' %}active{% endif %}">Reportes Diario</a>
        <a href="{% url 'reportes_historicos' %}" class="{% if request.resolver_match.url_name == 'reportes_historicos' %}active{% endif %}">Reportes Mensuales</a>
        <a href="{% url 'reporte_inversion_mensual' %}" class="{% if request.resolver_match.url_name == 'reporte_inversion' %}active{% endif %}">Reportes de Inversi√≥n</a>
      </div>

      <hr>

      <a href="{% url 'productos_a_bajar' %}" class="{% if request.resolver_match.url_name == 'productos_a_bajar' %}active{% endif %}">
        <i class="fa-solid fa-download"></i> Productos a bajar
      </a>

      <a href="{% url 'productos_a_pedir' %}" class="{% if request.resolver_match.url_name == 'productos_a_pedir' %}active{% endif %}">
        <i class="fa-solid fa-boxes-stacked"></i> Pedidos
      </a>

      <a href="{% url 'listar_proveedores' %}" class="{% if request.resolver_match.url_name == 'listar_proveedores' %}active{% endif %}">
        <i class="fa-solid fa-truck"></i> Proveedores
      </a>

      <a href="{% url 'listar_compras' %}" class="{% if request.resolver_match.url_name == 'listar_compras' %}active{% endif %}">
        <i class="fa-solid fa-receipt"></i> Compras
      </a>
    {% endif %}

    <hr>
    <a href="{% url 'logout' %}">
      <i class="fa-solid fa-right-from-bracket"></i> Cerrar sesi√≥n
    </a>
  </div>

  <!-- Main Content -->
  <div class="w-100">
    <div class="topbar">
      <h2>{% block title_page %}{% endblock %}</h2>
      {% if request.user.is_authenticated %}
        <div class="user"><i class="fa-solid fa-user"></i> {{ request.user.username }}</div>
      {% endif %}
    </div>

    <div class="content">
      {% block content %}
      {% endblock %}
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    window.addEventListener("load", () => {
      const loader = document.getElementById("loader");
      setTimeout(() => loader.classList.add("fade-out"), 400);
    });
  </script>
</body>
</html>
